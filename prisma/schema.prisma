// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")   // pooled (runtime)
  directUrl = env("DIRECT_URL")     // non-pooled (migrations)
}

// Month-to-date daily rollups used by the Overview dashboard
model DailyMetric {
  id        Int      @id @default(autoincrement())
  date      DateTime @unique
  revenue   Int?
  target    Int?
  occupancy Float?   // store as percent number, e.g. 46.0 for 46%
  arr       Int?
  notes     String?  @db.Text
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([date])
}

// Per-room-type daily rows (used by Room Types tab)
model RoomTypeMetric {
  id        Int      @id @default(autoincrement())
  date      DateTime
  type      String            // e.g. "Queen", "Deluxe Studio", "1 Bed", "2 Bed"

  rooms     Int?              // total rooms of this type (optional)
  available Int?              // room-nights available that day
  sold      Int?              // room-nights sold that day
  revenue   Int?              // revenue for this type that day
  rate      Int?              // average room rate for this type that day
  occupancy Float?            // store as percent number, e.g. 31.0 for 31%

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([date, type], name: "date_type") // one row per day per type
  @@index([date])
}
